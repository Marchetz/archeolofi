<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title></title>
        <link rel="stylesheet" type="text/css" href="libs/jquery.mobile-1.4.2/jquery.mobile-1.4.2.css">
        <link rel="stylesheet" type="text/css" href="libs/leaflet-0.7.3/leaflet.css" />
        <link rel="stylesheet" type="text/css" href="style.css" />
        <script type="text/javascript" src="libs/jquery-1.11.1.min.js"></script>
        <script type="text/javascript" src="libs/jquery.mobile-1.4.2/jquery.mobile-1.4.2.js"></script>
        <script type="text/javascript" src="libs/leaflet-0.7.3/leaflet.js"></script>

        <script src="functions.js"></script>
        <script>
            ///////////////////////////// BUTTONS /////////////////////////////
            $(document).ready( function() {
                $("#login_button").click( function() {
                    data = read_form("login");
                    if(!data)
                        return;
                    login(data[0], data[1]);
                });
            });

            $(document).ready( function() {
                $("#register_button").click( function() {
                    data = read_form("register");
                    if(!data)
                        return;
                    register(data[0], data[1], data[2]);
                });
            });

            $(function() {
                $('#upload').click(function() {
                    console.log($('#content_form'));
                    var comment = $('#content_form #comment').val();
                    if($('#content_form #file').val()) {
                        var form_data = new FormData($('#content_form')[0]);
                        var file_decription = $('#content_form #description').val();
                        upload(last_visited_id, comment, form_data, file_decription);
                    }
                    else
                        post_a_comment(last_visited_id, comment)
                });
            });
        </script>

        <!-- <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=no; target-densityDpi=device-dpi" /> -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    </head>

    <body>
        <div data-role="page" id="home">
            <div data-role="header" data-position="inline">
                <h1>Indiana Mapps</h1>
                <a href="#login" data-role="button" class="ui-btn-right" >Login</a>
            </div>
            <div data-role="content" >
                <div id="map" class="map" ></div>
            </div>
        </div>

    <!-- ============================== INFO ============================== -->
        <div data-role="page" id="info">
            <div data-role="header" >
                <h1>Info</h1>
                <a href="#home">Map</a>
            </div>

            <div data role="content">
                <div data-role="collapsible-set">
                    <div data-role="collapsible" data-collapsed="false" id="info_sito">
                        <h3>INFORMAZIONI</h3>
                        <p id="more_info">
                            <h4>Descrizione approfondita:</h4><span id="descri"></span>
                            <hr />
                            <div id="bibliography">
                                <h4>Bibliografia:</h4>
                                <span id="biblio"></span>
                            </div>
                            <div id="gallery">
                                <hr />
                                <h4>Immagini:</h4>
                                <span id="image"></span>
                            </div>
                        </p>
                    </div>

                    

                        <!-- <h3>COMMENTI UTENTI</h3>
                        <p>
                            <form name= "comment">
                                <div data-role="fieldcontain" id="insert_comment">
                                    <h4>Inserisci il tuo commento:</h4>
                                    
                                    <textarea cols="30" rows="15"  name="text_comment" id="text_comment"  required/></textarea>
                                    <div> 
                                    <input type="button" id="send_comment"  data-icon="comment" value="Pubblica commento">
                                    <input type="button" id="send_content"  data-icon="camera" value="Pubblica foto">
                                    </div>
                                </div>
                            </form>    

                        </p> -->
                
                <!-- <div data-role="collapsible" data-collapsed-icon="arrow-d" data-expanded-icon="arrow-u">
                                    <h4>COMMENTI</h4>
                                    <p>
                                    <div data-role="fieldcontain" class="single_comment">
                                        <span  class="view_text_comment">Ciao a tutti, consiglio a tutti di vedere questo sito archeologico, veramente molto bello.
                                        Vorrei anche ringraziare Emilio e Francesco per questa app fantastica, sono veramenti dei ganzi! </span>
                                        <div class="properties_comment" >
                                            <span class="user_comment">francesco marchetti</span>
                                            <span class="data_hours">28 agosto 15:00</span>
                                             
                                        </div>
                                        <div data-role="controlgroup" data-type="horizontal">
                                            <input type="button" id="send_comment"   value="Mi piace">
                                            <input type="button" id="send_content"   value="Non mi piace">
                                            
                                            
                                        </div>
                                    </div>
                                    
                                    
                                    
                                    <div class="single_comment">
                                        <span class="view_text_comment">secondo commento</span>
                                        <div class="properties_comment">
                                            <span class="user_comment">francesco marchetti</span>
                                            <span class="data_hours">28 agosto 15:10</span>
                                            
                                        </div>
                                    </div>
                                    </p>
                                    
                                    
                        </div> -->
                                
                

                
                    

                    <div data-role="collapsible">
                        <h3>AGGIUNGI UN CONTENUTO</h3>
                        <div id="add_content">
                            <form id="content_form" method="post" enctype="multipart/form-data">
                                <div data-role="fieldcontain">
                                    <label for="comment">Inserisci un tuo commento:</label>
                                    <textarea name="comment" id="comment" /></textarea>
                                </div>
                                <div data-role="fieldcontain">
                                    <fieldset>
                                        <label for="file">Seleziona un file:</label>
                                        <input name="file" type="file" id="file">
                                    </fieldset>
                                    <fieldset>
                                        <label for="description">Descrivi il file:</label>
                                        <input name="description" type="text" id="description">
                                    </fieldset>
                                </div>
                                <div data-role="fieldcontain">
                                    <button id="upload" type="button" data-icon="comment">Pubblica</button>
                                </div>
                            </form>
                        </div>
                        <div id="login_required">
                            fai login prima di aggiungere un contenuto:
                            <a href="#login" data-role="button">Login</a>
                        </div>

                        <div data-role="collapsible" data-collapsed-icon="arrow-d" data-expanded-icon="arrow-u">
                            <h4>CONTENUTI</h4>
                            <div id="contents"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    <!-- ======================== LOGIN & REGISTER ======================== -->
        <div data-role="page" id="login">
            <div data-role="header" >
                <a href="#home">Map</a>
                <h2>Login</h2>
            </div>
            <div data-role="content">
                <form name="login" id="user_data">
                    <div data-role="fieldcontain" class="ui-hide-label">
                        <label for="username">Username:</label>
                        <input type="text" name="name" id="name" value="" placeholder="Username" required/>
                    </div>

                    <div data-role="fieldcontain" class="ui-hide-label">
                        <label for="password">Password:</label>
                        <input type="password" name="psw" id="psw" value="" placeholder="Password" required/>
                    </div>

                    <input type="button" id="login_button" data-icon="check" value="Accedi">
                
                    <div data-role="collapsible" data-collapsed="true" data-theme="a" id="registration">
                        <h3>Registrazione</h3>
                        <p>Se non sei ancora registrato inserisci anche la tua email:</p>
                        <div data-role="fieldcontain" class="ui-hide-label">
                            <label for="email">email:</label>
                            <input type="text" name="email" id="email" value="" placeholder="email" />
                        </div>

                        <input type="button" id="register_button" data-icon="edit" value="Registrati">
                    </div>
                </form>
            </div>
        </div>

        <!-- =========================== POPUP =========================== -->
        <div class="hidden" id="popup_ritrovamento">
            <h3 class="pop_elem"><!-- definizione --></h3>
            <p class="pop_elem"><!-- descrizione_min --></p>
            <span id="periodo" class="pop_elem ritr"></span>
            <span id="tipologia_ritrov" class="pop_elem ritr"></span>
            <a href="#info" id="passinfo"  class="ui-btn ui-icon-plus ui-btn-icon-left" data-icon="plus">
                Altre informazioni
            </a>
        </div>
        <div class="hidden" id="popup_intervento">
            <h3 class="pop_elem"><!-- tipo_intervento --></h3>
            <time id="data_compilazione" class="pop_elem"></time>
            <ul class="pop_elem">
                <li>
                    metodo: <span id="metodo" class="pop_elem inte"></span>
                </li>
                <li>
                    direzione scientifica: <span id="dir_scentifica" class="pop_elem inte"></span>
                </li>
                <li>
                    ente responsabile: <span id="ente_resp" class="pop_elem inte"></span>
                </li>
                <li>
                    ente schedatore: <span id="ente_schedatore" class="pop_elem inte"></span>
                </li>
                <li>
                    esecutore intervento: <span id="esecutore_intervento" class="pop_elem inte"></span>
                </li>
                <li>
                    tipo particella: <span id="tipo_particella" class="pop_elem inte"></span>
                </li>
            </ul>
            <a href="#info" id="passinfo"  class="ui-btn ui-icon-plus ui-btn-icon-left" data-icon="plus">
                Altre informazioni
            </a>
        </div>

        <script src="map_functions.js"></script>
    </body>
</html>
